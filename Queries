-- 1.What are the details of all cars purchased in the year 2022?

SELECT CAR_ID, MAKE, TYPE, STYLE, COST_$, group_concat(PURCHASE_DATE) AS PURCHASE_DATE 
FROM CARS 
JOIN SALES 
USING(CAR_ID) 
WHERE YEAR(PURCHASE_DATE) = "2022" 
GROUP BY CAR_ID;

-- 2.What is the total number of cars sold by each salesperson?

SELECT SALESMAN_ID, NAME AS SALESPERSON, COUNT(CAR_ID) AS TOTAL_CARS 
FROM SALES
JOIN SALESPERSONS
USING(SALESMAN_ID)
GROUP BY SALESPERSON;

-- 3.What is the total revenue generated by each salesperson?

SELECT NAME AS SALESPERSON, SUM(COST_$) AS TOTAL_REVENUE 
FROM SALESPERSONS
JOIN SALES
USING(SALESMAN_ID)
JOIN CARS
USING(CAR_ID)
GROUP BY SALESPERSON;

-- 4.What are the details of the cars sold by each salesperson?

SELECT NAME AS SALESPERSON, MAKE, TYPE, STYLE, COST_$ FROM SALESPERSONS
JOIN SALES 
USING(SALESMAN_ID)
JOIN CARS
USING(CAR_ID);

-- 5.What is the total revenue generated by each car type?

SELECT TYPE AS CAR_TYPE, SUM(COST_$) AS TOTAL_REVENUE 
FROM CARS 
JOIN SALES
USING(CAR_ID)
GROUP BY CAR_TYPE;

-- 6.What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?

SELECT NAME AS SALESPERSON, MAKE, TYPE, STYLE, COST_$ 
FROM SALESPERSONS
JOIN SALES 
USING(SALESMAN_ID)
JOIN CARS
USING(CAR_ID)
WHERE NAME = "EMILY WONG"
AND YEAR(PURCHASE_DATE) = "2021";

-- 7.What is the total revenue generated by the sales of hatchback cars?

SELECT STYLE , SUM(COST_$) AS TOTAL_REVENUE 
FROM CARS
JOIN SALES
USING(CAR_ID) 
WHERE STYLE = "HATCHBACK";

-- 8.What is the total revenue generated by the sales of SUV cars in the year 2022?

SELECT STYLE, YEAR(PURCHASE_DATE) AS PURCHASE_YEAR, SUM(COST_$) AS TOTAL_REVENUE 
FROM CARS 
JOIN SALES
USING(CAR_ID)
WHERE STYLE = "SUV"
AND YEAR(PURCHASE_DATE) = "2022";

-- 9.What is the name and city of the salesperson who sold the most number of cars in the year 2023?

SELECT NAME AS SALESPERSON, CITY ,YEAR(PURCHASE_DATE) AS YEAR, COUNT(CAR_ID) AS TOTAL_CARS
FROM SALESPERSONS
JOIN SALES
USING(SALESMAN_ID)
JOIN CARS
USING(CAR_ID)
WHERE YEAR(PURCHASE_DATE) = "2023"
GROUP BY SALESPERSON 
ORDER BY TOTAL_CARS DESC
LIMIT 1;

-- 10.What is the name and age of the salesperson who generated the highest revenue in the year 2022?

SELECT NAME AS SALESPERSON, AGE, YEAR(PURCHASE_DATE) AS YEAR, SUM(COST_$) AS TOTAL_REVENUE
FROM SALESPERSONS
JOIN SALES
USING(SALESMAN_ID)
JOIN CARS
USING(CAR_ID)
WHERE YEAR(PURCHASE_DATE) = "2022"
GROUP BY SALESPERSON
ORDER BY TOTAL_REVENUE DESC
LIMIT 1;
